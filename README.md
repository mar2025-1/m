أكيد! خلينا نبدأ بتوثيق أول قسم رئيسي في مشروع “مارد”، وهو:

⸻

🏠 الشاشة الرئيسية (home_view.dart)

📌 الاسم:

الرئيسية – home_view.dart

🎯 الوظيفة:

تمثل الشاشة الأساسية للمستخدم عند فتح التطبيق، ومهمتها إدخال رابط الفيديو أو الانتقال للمتصفح المدمج لتحميل محتوى من أي موقع.
تقوم بتحليل الرابط، وإظهار معلومات الفيديو، وخيارات التحميل (بما في ذلك الصوت فقط).

⸻

🧱 المكونات الأساسية:
‏	1.	✅ AppBar علوي:
	•	عنوان واضح: “مـارد”
	•	شفاف (بدون ظل)
	•	لا يحتوي على أيقونات إضافية
	2.	🌄 خلفية خلف الشاشة:
	•	صورة طبيعية موحدة موجودة في assets/background.jpg
	•	يغطيها Overlay لتتوافق مع الوضع الليلي والسطوع
	3.	🔗 حقل إدخال رابط الفيديو:
	•	مربع إدخال أنيق
	•	يحتوي على زر “لصق” كأيقونة داخل الحقل
	•	بجانبه زر “تحميل” مع أيقونة التنزيل
	4.	🎬 معلومات الفيديو بعد التحليل:
	•	تظهر في حال تم تحليل الرابط بنجاح
	•	تعرض:
	•	اسم الفيديو
	•	الجودة المتاحة (DropDown)
	•	الحجم التقريبي
	•	خيار “تحميل صوت فقط”
	5.	🌐 زر عائم (FAB):
	•	أيقونة متصفح
	•	عند الضغط عليه → ينتقل إلى شاشة المتصفح browser_view.dart

⸻

🧠 الذكاء الداخلي والسلوك:
	•	عند لصق رابط أو كتابته:
	•	يتم التحقق من صيغته وصلاحيته
	•	إذا كان الرابط يخص موقع غير مدعوم مباشرة → يتم تحويله إلى المتصفح
	•	إذا كان من موقع مثل YouTube → يتم إرساله إلى الخادم
	•	يتم عرض معلومات الفيديو تلقائيًا إن توفرت
	•	تجربة الاستخدام للمستخدم المجاني:
	•	يمكنه التحميل حتى جودة 480p
	•	إذا اختار جودة أعلى → يتم توجيهه إلى الاشتراك

⸻

⚙️ الربط بالملفات الأخرى:
‏	•	controller: home_controller.dart
‏	•	widget:
‏	•	link_input_field.dart
‏	•	custom_button.dart
‏	•	video_info_card.dart
	•	الخدمات المستخدمة:
‏	•	youtube_service.dart
‏	•	download_service.dart
‏	•	ad_service.dart (لعرض إعلان بيني بعد التحميل)

⸻

📄 ملاحظات إضافية:
	•	لا يوجد عرض لقائمة فيديوهات هنا، فقط رابط واحد وتحليله.
	•	عرض الفيديو يتم بشكل تفاعلي وذكي بناءً على حالة الرابط.
	•	الخلفية ثابتة في جميع الشاشات لتعزيز الهوية البصرية.
	•	في حالة فشل التحميل، يظهر Snackbar أو Dialog لتوضيح السبب.

⸻

تمام، نتابع الآن مع توثيق القسم الثاني:

⸻

🌐 شاشة المتصفح (browser_view.dart)

📌 الاسم:

المتصفح – browser_view.dart

🎯 الوظيفة:

شاشة تسمح للمستخدم بتصفح أي موقع من داخل التطبيق، وتُستخدم لاكتشاف الفيديوهات التي لا يمكن تحميلها مباشرة من الشاشة الرئيسية.
مثالية لمواقع التواصل الاجتماعي أو مواقع الفيديو التي لا تدعم روابط مباشرة.

⸻

🧱 المكونات الأساسية:
‏	1.	✅ AppBar علوي:
	•	يحتوي على زر رجوع
	•	يحتوي على شريط عنوان يظهر الرابط الحالي
	•	إمكانية إضافة زر “نسخ الرابط” أو “إعادة تحميل”
‏	2.	🌍 WebView مدمج:
	•	يعرض محتوى الصفحة بشكل كامل داخل التطبيق
	•	يمنع الإعلانات المنبثقة والمواقع غير الآمنة
	•	يدعم حفظ الجلسة
	3.	📥 زر التحميل العائم (يظهر تلقائيًا):
	•	يظهر فقط عند اكتشاف فيديو
	•	عند الضغط عليه تظهر نافذة منبثقة تحتوي على:
	•	اسم الفيديو
	•	الجودة المتوفرة (Dropdown)
	•	الحجم التقريبي
	•	زر “تحميل”
	•	زر “تحميل كصوت”

⸻

🧠 السلوك الذكي:
	•	تحليل تلقائي للصفحة:
	•	عند تحميل أي صفحة → يتم فحص المحتوى الخلفي (DOM) لاكتشاف ملفات الفيديو
	•	عند اكتشاف الفيديو → يتم عرض زر التحميل تلقائيًا
	•	في حال كان الموقع مثل YouTube أو TikTok:
	•	يتم إرسال الرابط إلى الخادم mard-api
	•	يتم جلب البيانات وعرضها للمستخدم مع خيارات التحميل
	•	في حال فشل التحليل داخل التطبيق:
	•	يظهر خيار “إرسال للسيرفر لتحليل المحتوى”

⸻

⚙️ الربط بالملفات الأخرى:
‏	•	controller: browser_controller.dart
	•	الخدمات:
‏	•	download_service.dart
‏	•	youtube_service.dart
‏	•	webview_flutter أو flutter_inappwebview

⸻

🔐 القيود للمستخدم المجاني:

الخاصية	مجاني	مشترك
تحميل فيديو من المتصفح	✅	✅
تحميل بجودة عالية	❌ حتى 480p فقط	✅ حتى 4K
تحميل صوت فقط	✅	✅
مشاهدة إعلان بعد التحميل	✅	❌



⸻

📄 ملاحظات إضافية:
	•	لا يظهر زر التحميل إلا عند التأكد من أن الفيديو جاهز.
	•	يدعم خاصية “التمرير للخلف” في WebView.
	•	يُفضل تفعيل وضع الأمان Safe Browsing.
	•	يمكن لاحقًا إضافة خاصية حظر الإعلانات.

⸻

ممتاز، نكمل الآن مع توثيق شاشة التنزيلات:

⸻

تمام، ننتقل الآن لتوثيق شاشة التنزيلات بشكل كامل:

⸻

📥 شاشة التنزيلات – downloads_view.dart

📌 الاسم:

التنزيلات – downloads_view.dart

⸻

🎯 الوظيفة:

تعرض الملفات قيد التنزيل فقط، مع إمكانية إدارة حالة كل تنزيل (إيقاف، استئناف، إلغاء).

⸻

🧱 المكونات الرئيسية:
	1.	✅ AppBar علوي:
	•	عنوان: “التنزيلات”
	•	تصميم بسيط ومتناسق مع باقي الشاشات
‎	2.	⬇️ قائمة التنزيلات النشطة:
	•	لكل ملف يُعرض:
	•	الاسم
	•	نوع المحتوى (أيقونة فيديو/صوت)
	•	نسبة التقدم (Progress Bar)
	•	الحجم المحمل / الكلي
	•	سرعة التحميل
	•	الوقت المتبقي التقريبي
	•	زر “إيقاف مؤقت / استئناف”
	•	زر “إلغاء التنزيل”

⸻

🛠️ خيارات عند الضغط على أي ملف:
	•	✅ إيقاف مؤقت / متابعة
	•	❌ إلغاء التنزيل

⸻

❗️ التنزيلات المكتملة:
	•	تُزال تلقائيًا من هنا وتُنقل مباشرة إلى شاشة “ملفاتي”
	•	لا يتم عرض سجل للتنزيلات المكتملة هنا (تم الاستغناء عن السجل لتقليل الزحمة)

⸻

🧠 السلوك الذكي:
	•	يتم الاستئناف التلقائي عند استقرار الاتصال بالإنترنت.
	•	التنزيلات المتوقفة يتم الإبقاء عليها في القائمة مع توضيح السبب.
	•	يظهر تنبيه في حال فشل التنزيل أو امتلاء المساحة.

⸻

🔁 الاستئناف التلقائي:
	•	في حال انقطاع الإنترنت، يقوم التطبيق بمحاولة استئناف التنزيل تلقائيًا عند استعادة الاتصال.
	•	يتم عرض حالة التنزيل بشكل مباشر للمستخدم.

⸻

🔐 القيود حسب نوع الحساب:

الخاصية	مجاني	مشترك
عدد التنزيلات اليومية	حتى 5 GB	غير محدود
جودات عالية (720p+)	❌	✅
إعلانات بعد التنزيل	✅	❌



⸻

📦 الربط بالملفات الأخرى:
	•	controller: download_controller.dart
‎	•	الخدمات:
	•	download_service.dart
	•	file_service.dart
	•	storage_service.dart
	•	notification_service.dart
	•	permission_service.dart

⸻

🎨 ملاحظات تصميمية:
	•	تصميم متناسق مع الثيم العام
	•	عرض التنزيلات بشكل مريح وواضح
	•	دعم الوضع الليلي تلقائيًا
	•	استخدام ألوان لتمييز حالات التنزيل:
	•	⏳ رمادي: قيد الانتظار
	•	✅ أخضر: جاري التنزيل
	•	❌ أحمر: فشل أو موقوف يدويًا

⸻

⸻

📁 شاشة ملفاتي – my_files_view.dart

📌 الاسم:

ملفاتي – my_files_view.dart

🎯 الوظيفة:

تعرض جميع الملفات التي تم تحميلها بنجاح في التطبيق، وتوفّر أدوات متقدمة لإدارتها وتشغيلها ورفعها للسحابة.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	عنوان الشاشة: “ملفاتي”
	•	لا يحتوي على أزرار إضافية، تصميم بسيط وثابت
	2.	🗂️ قائمة الملفات:
	•	كل ملف يظهر كمكون تفاعلي يحتوي على:
	•	اسم الملف
	•	نوع المحتوى (أيقونة فيديو / صوت / ملف آخر)
	•	حجم الملف
	•	التاريخ
	•	الحالة (مرفوع أم لا)
	•	مدة التشغيل (للفيديو والصوت)
	3.	➕ زر عائم (Floating Action Button):
	•	يظهر بأسفل يمين الشاشة
	•	عند الضغط: تظهر خيارات (Bottom Sheet):
	•	رفع إلى Google Drive
	•	مشاركة الملف
	•	إعادة التسمية
	•	تحويل إلى صوت (إن كان فيديو)
	•	إخفاء
	•	ضغط الملف
	•	حذف

⸻

📦 نظام المجلدات:
	•	يدعم تنظيم الملفات داخل مجلدات فرعية.
	•	المستخدم يستطيع إنشاء مجلدات جديدة أو نقل الملفات إليها.
	•	سلة المحذوفات تعامل كمجلد دائم يظهر دائمًا في الأسفل.

⸻

🗑️ سلة المحذوفات:
	•	لا يتم حذف الملفات نهائيًا فورًا.
	•	عند حذف أي ملف → ينتقل تلقائيًا إلى “سلة المحذوفات”.
	•	الملفات تُحتفظ بها 30 يومًا ثم تُحذف تلقائيًا.
	•	يمكن للمستخدم استعادة أو حذف الملفات يدويًا.

⸻

🔒 الملفات المخفية:
	•	لا تظهر هنا.
	•	يمكن فقط الوصول إليها من “الملفات المخفية”.
	•	عند الإخفاء يتم نقل الملف إلى مجلد داخلي محمي.

⸻

⬆️ الرفع إلى Google Drive:
	•	زر خاص يظهر مع كل ملف.
	•	الحالة تظهر بأيقونة (✅ مرفوع / ⬆️ لم يُرفع / ⏳ جارٍ الرفع).
	•	الرفع يتطلب تسجيل دخول واشتراك.

⸻

🔐 القيود للمستخدم المجاني:

الخاصية	مجاني	مشترك
عدد الملفات المخفية	حتى 50	غير محدود
رفع إلى Google Drive	❌	✅
تحويل إلى صوت	✅	✅
ضغط الفيديو	❌	✅
تعديل الاسم	✅	✅
حذف نهائي	✅	✅



⸻

🧠 الربط بالملفات الأخرى:
‏	•	controller: file_controller.dart
	•	الخدمات:
‏	•	file_service.dart
‏	•	upload_service.dart
‏	•	storage_service.dart
‏	•	conversion_service.dart
‏	•	hidden_file_service.dart
‏	•	trash_service.dart

⸻

🎨 ملاحظات تصميمية:
	•	دعم الوضع الليلي تلقائيًا.
	•	تصميم مرن وسهل التنقل.
	•	عرض المجلدات دائمًا في أعلى القائمة.
	•	سلة المحذوفات عنصر ثابت لا يختفي.

⸻

تمام، ننتقل الآن إلى توثيق شاشة الملفات المخفية بالتفصيل:

⸻

🕵️‍♂️ شاشة الملفات المخفية – hidden_files_view.dart

📌 الاسم:

الملفات المخفية – hidden_files_view.dart

⸻

🎯 الوظيفة:

تمكّن المستخدم من الوصول إلى الملفات التي قام بإخفائها يدويًا من شاشة “ملفاتي”، وتكون محمية ولا تظهر في مدير الملفات أو المعرض.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	عنوان: “الملفات المخفية”
	•	زر رجوع إلى شاشة “المزيد”
	2.	🔒 قائمة الملفات المخفية:
	•	كل ملف يظهر في شكل ListTile أو Card يحتوي على:
	•	اسم الملف
	•	نوعه (صوت/فيديو/مستند)
	•	تاريخ الإخفاء
	•	الحجم
	•	المدة (إذا كان فيديو/صوت)
	3.	🧰 خيارات عند الضغط على ملف:
	•	تشغيل (داخل التطبيق فقط)
	•	إظهار في “ملفاتي”
	•	مشاركة (في حال التفعيل لاحقًا)
	•	حذف (نقل إلى سلة المحذوفات)

⸻

🔐 الحماية والخصوصية:
	•	لا يمكن الوصول إلى هذه الملفات من خارج التطبيق.
	•	لا تظهر في الاستوديو أو مدير الملفات.
	•	يمكن تفعيل قفل الشاشة (بصمة / كلمة مرور) من الإعدادات للوصول إلى هذا القسم (خاص بالمشتركين).
	•	يتم تخزين هذه الملفات في مجلد داخلي hidden/ داخل getApplicationDocumentsDirectory.

⸻

🧠 الذكاء والسلوك:
	•	يتم تحديث القائمة مباشرة عند الإخفاء أو الإظهار.
	•	عند محاولة تشغيل ملف غير مدعوم، يظهر تنبيه.
	•	الملفات لا تُفك حمايتها إلا يدويًا من المستخدم نفسه.

⸻

🔁 عند الإظهار:
	•	يعود الملف تلقائيًا إلى “ملفاتي”
	•	يتم نقله فعليًا من مجلد hidden/ إلى downloads/

⸻

🔐 القيود حسب نوع الحساب:

الخاصية	مجاني	مشترك
الحد الأعلى للحجم	حتى 5GB أو 50 ملف	غير محدود
الوصول الآمن	❌	✅ بصمة أو كلمة مرور
المشاركة	❌	✅



⸻

📦 الربط بالملفات الأخرى:
‏	•	controller: hidden_controller.dart
	•	الخدمات:
‏	•	hidden_file_service.dart
‏	•	storage_service.dart
‏	•	secure_storage_service.dart
‏	•	permission_service.dart

⸻

🎨 ملاحظات تصميمية:
	•	تصميم أنيق ومظلم افتراضيًا لمزيد من الخصوصية
	•	رسائل تنبيه واضحة عند إلغاء الإخفاء أو حذف الملف
	•	زر “تشغيل الكل” (اختياري لاحقًا)

⸻

رائع، ننتقل الآن إلى توثيق شاشة “سلة المحذوفات” بالتفصيل:

⸻

🗑️ شاشة سلة المحذوفات – trash_view.dart

📌 الاسم:

سلة المحذوفات – trash_view.dart

⸻

🎯 الوظيفة:

تعرض للمستخدم الملفات التي تم حذفها من “ملفاتي” أو “الملفات المخفية”، ولكن لم تُحذف نهائيًا بعد.
تتيح للمستخدم إما استرجاع الملفات أو حذفها نهائيًا.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	عنوان: “سلة المحذوفات”
	•	لا يحتوي على أزرار إضافية
	2.	📄 قائمة الملفات المحذوفة:
	•	كل ملف يظهر بـ Card أو ListTile يحتوي على:
	•	اسم الملف
	•	نوعه
	•	تاريخ الحذف
	•	حجم الملف
	•	مصدر الملف (من ملفاتي أو الملفات المخفية)
	•	عدد الأيام المتبقية قبل الحذف التلقائي
	3.	⚙️ خيارات عند الضغط على الملف:
	•	استرجاع
	•	حذف نهائي
	4.	❗️ رسالة تحذير عند الحذف النهائي:
	•	“هل أنت متأكد أنك تريد حذف هذا الملف نهائيًا؟ لا يمكن التراجع.”

⸻

🔄 السلوك الذكي:
	•	يتم نقل الملفات إلى مجلد داخلي trash/ بدل حذفها الفوري.
	•	يتم عرض عداد تنازلي (30 يومًا) لكل ملف قبل حذفه تلقائيًا.
	•	الملفات تُفرغ تلقائيًا كل 30 يومًا بدون تدخل المستخدم.
	•	يمكن للمستخدم استرجاع الملفات في أي وقت خلال المدة.

⸻

🧠 الخصائص الإضافية:

الخاصية	وصف
الحذف المؤجل	لا يتم الحذف النهائي إلا بعد 30 يومًا
استعادة الملف	يعود الملف تلقائيًا إلى “ملفاتي” أو “الملفات المخفية” حسب مصدره
دعم الوسائط	يمكن عرض بيانات الفيديو/الصوت لكن لا يمكن تشغيله من السلة
دعم تحديد متعدد	لاحقًا: يمكن تحديد أكثر من ملف لحذفهم أو استرجاعهم دفعة واحدة



⸻

🔐 القيود:

الخاصية	مجاني	مشترك
استرجاع الملفات	✅	✅
حذف نهائي	✅	✅
المدة القصوى في السلة	30 يوم	30 يوم



⸻

📦 الربط بالملفات الأخرى:
‏	•	controller: trash_controller.dart
	•	الخدمات:
‏	•	trash_service.dart
‏	•	storage_service.dart
‏	•	permission_service.dart

⸻

🎨 الملاحظات التصميمية:
	•	تصميم بسيط وواضح
	•	يتم تمييز الملفات حسب نوعها
	•	عرض عدد الأيام المتبقية بشكل ملون (أحمر عند الاقتراب من 0)

⸻

🛠️ الربط بالإعدادات:
	•	في قسم الإعدادات يوجد خيار:
	•	تفعيل/تعطيل سلة المحذوفات
	•	عند تعطيلها: يتم حذف الملفات نهائيًا فورًا بدون نقل للسلة

⸻

جميل، ننتقل الآن لتوثيق قسم المزيد – more_view.dart بالتفصيل:

⸻

⋮ شاشة المزيد – more_view.dart

📌 الاسم:

المزيد – more_view.dart

⸻

🎯 الوظيفة:

تُعد واجهة مركزية للوصول السريع إلى الأقسام الجانبية والإعدادات داخل التطبيق، وتعرض وظائف الإدارة والمعلومات والدعم.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	عنوان الشاشة: “المزيد”
	•	تصميم بسيط وثابت
	2.	📋 قائمة بالأقسام التالية (مرتبة):

العنصر	الوظيفة
حسابي	الانتقال إلى account_view.dart لعرض معلومات الحساب
الاشتراكات	الانتقال إلى subscription_view.dart للاطلاع على الباقات
الإعدادات	الانتقال إلى settings_view.dart لتخصيص تجربة المستخدم
تواصل معنا	يعرض الإيميل support@maard.app (بدون فتح تواصل مباشر)
سياسة الخصوصية	فتح صفحة privacy_policy.html من الإنترنت
تقييم التطبيق	يفتح رابط التقييم في متجر التطبيقات
مشاركة التطبيق	زر لمشاركة رابط التحميل
حول التطبيق	عرض معلومات النسخة وحقوق الملكية (Mard Studio © 2025)



⸻

📥 الخصائص:
	•	قابل للتوسعة مستقبلًا
	•	متكامل مع واجهة التطبيق الرسمية (لا يحتوي على BottomNavigationBar)
	•	يدعم الوضع الليلي والتفاعلي

⸻

🔐 الربط مع الاشتراكات:
	•	بعض العناصر تظهر فقط للمستخدم المسجّل
	•	الضغط على الاشتراكات يتطلب تسجيل الدخول:
	•	إذا لم يكن مسجلاً → يظهر له واجهة تسجيل الدخول أولاً (account_view.dart)

⸻

🧩 ملفات الربط:

القسم	الملف
واجهة المستخدم	more_view.dart
تحكم داخلي	setting_controller.dart
ربط الحساب	user_controller.dart
الاشتراكات	subscription_controller.dart



⸻

🔗 روابط افتراضية داخلية:

العنصر	رابط
سياسة الخصوصية	https://github.com/mard22/AI/blob/master/privacy_policy.html
التواصل	mailto:support@maard.app
المشاركة	Share.share(appDownloadLink)



⸻

✳️ ملاحظات إضافية:
	•	لا يتم تحميل أو تفعيل أي خدمة من “المزيد”، بل هو مجرد مركز توجيه.
	•	جميع التنقلات تتم عبر Get.toNamed().

⸻

تمام، نبدأ بتوثيق أول عنصر في قائمة “المزيد” وهو:

⸻

1. حسابي – account_view.dart

📌 الاسم:

حسابي – account_view.dart

⸻

🎯 الوظيفة:

تمكن المستخدم من عرض بيانات الحساب الشخصية، حالة الاشتراك، وخيارات تسجيل الدخول/الخروج.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	العنوان: “حسابي”
	•	تصميم ثابت
	2.	👤 معلومات المستخدم:
	•	الاسم (أو البريد الإلكتروني)
	•	صورة رمزية افتراضية
	•	حالة تسجيل الدخول (نص: “تسجيل الدخول” أو “تم تسجيل الدخول”)
	•	حالة الاشتراك (مميز / مجاني)
	3.	🔐 أزرار التفاعل:
	•	تسجيل الدخول (في حال كان غير مسجل)
	•	تسجيل الخروج (إذا كان مسجلًا)
	•	إدارة الحساب (اختياري مستقبلاً)

⸻

🧠 الخصائص الذكية:

الحالة	السلوك
غير مسجل	يظهر زر “تسجيل الدخول”
مسجل	يظهر زر “تسجيل الخروج” + حالة الاشتراك
مميز	يظهر شارة Premium بجانب الاسم



⸻

🗃️ الاعتماد على:

العنصر	الملف
تحكم الحالة	user_controller.dart
البيانات الآمنة	secure_storage_service.dart
التحقق من الاشتراك	subscription_service.dart
‏Firebase Auth (لاحقًا)	ربط فعلي إن تم التفعيل



⸻

⚙️ الميزات المستقبلية (لاحقًا):
	•	إدارة الحساب (تغيير اسم – تغيير بريد – كلمة مرور)
	•	تفعيل المصادقة الثنائية
	•	دعم Apple Sign-In و Google Sign-In

⸻

✳️ ملاحظات إضافية:
	•	أي محاولة لفتح قسم الاشتراكات من “المزيد” تتطلب تسجيل الدخول مسبقًا.
	•	عند تسجيل الدخول، يتم تحميل البيانات من الخادم (إذا تم الربط لاحقًا).

⸻

جميل، ننتقل الآن لتوثيق:

⸻

2. الاشتراكات – subscription_view.dart

📌 الاسم:

الاشتراكات – subscription_view.dart

⸻

🎯 الوظيفة:

تمكّن المستخدم من عرض خطط الاشتراك، مميزات الباقة المدفوعة، وشراء الاشتراك عبر المتجر (Google / Apple).

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	العنوان: “الاشتراكات”
	•	زر رجوع فقط
	2.	💎 بطاقات الخطط:
	•	الخطة المجانية (Free):
	•	محدودة التحميل: حتى 5GB يوميًا
	•	جودة التحميل: حتى 480p
	•	الملفات المخفية: حتى 5GB أو 50 ملفًا
	•	إعلانات بعد كل تحميل
	•	تحويل الفيديو إلى صوت (متاح)
	•	الخطة المميزة (Premium):
	•	تحميل غير محدود
	•	جودة عالية (Full HD / 4K)
	•	لا إعلانات
	•	مساحة غير محدودة للملفات المخفية
	•	دعم Google Drive تلقائي
	•	أدوات إضافية (تحرير الفيديو، ضغط، تقطيع، الخ…)
	3.	✅ زر الاشتراك:
	•	يظهر على الخطة المدفوعة فقط
	•	يقوم بفتح واجهة الدفع عبر Google Play / Apple Store
	•	يتم التحقق من الاشتراك وربطه بحساب المستخدم تلقائيًا

⸻

🧠 الخصائص الذكية:

الحالة	السلوك
غير مسجل دخول	يتم توجيه المستخدم إلى صفحة تسجيل الدخول
مشترك	تظهر شارة “أنت مشترك” ويُمنع تكرار الدفع
خلال فترة تجريبية	يظهر عدد الأيام المتبقية



⸻

⚙️ الاعتماد على:

العنصر	الملف
عملية الشراء	in_app_purchase
التحقق من الاشتراك	subscription_controller.dart
حالة المستخدم	user_controller.dart



⸻

❗ملاحظات مهمة:
	•	يتم تحديث الأسعار من المتجر مباشرة حسب الدولة.
	•	يتم إرسال رمز الاشتراك والتحقق منه في الخادم المرتبط.
	•	الاشتراك مرتبط بالحساب، وليس بالجهاز فقط.

⸻

الخيارات المستقبلية (لاحقًا):
	•	عرض تفاصيل المدفوعات وسجل الفواتير.
	•	إلغاء أو إدارة الاشتراك من داخل التطبيق.

⸻

جميل، ننتقل الآن إلى توثيق:

⸻

3. الإعدادات – settings_view.dart

📌 الاسم:

الإعدادات – settings_view.dart

⸻

🎯 الوظيفة:

تمكّن المستخدم من التحكم في إعدادات التطبيق العامة مثل المظهر، اللغة، الإشعارات، التخزين، وسلة المحذوفات.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	العنوان: “الإعدادات”
	•	زر رجوع فقط
	2.	⚙️ خيارات الإعدادات (مُصنفة):

القسم	الخيارات
المظهر	

	•	الوضع الليلي (زر سويتش): يفعّل / يعطّل الوضع المظلم
	•	الوضع التلقائي (زر سويتش): يعتمد إعدادات النظام
ملاحظة: لا يمكن تفعيل الاثنين معًا، اختيار أحدهما يلغي الآخر.
| اللغة |
	•	اللغة الحالية (عربية / إنجليزية)
	•	يتم تجاهل اللغة التلقائية عند التغيير يدويًا
| التنزيل |
	•	عدد التنزيلات المتزامنة (مستقبلاً)
| التشغيل بالخلفية |
	•	زر تفعيل الصوت / الفيديو بالخلفية (مُتاح فقط للمشتركين)
| الإشعارات |
	•	تفعيل / تعطيل الإشعارات العامة
| التخزين |
	•	عرض المساحة المستخدمة
	•	زر “إفراغ سلة المحذوفات يدويًا”
| الخصوصية |
	•	زر تفعيل “سلة المحذوفات” (إذا تم تفعيله تظهر مجلد “سلة المحذوفات” في ملفاتي)
	•	دعم حماية الملفات لاحقًا (بصمة / كلمة مرور)
| الأمان |
	•	ربط الاستعادة بكلمة المرور عند تسجيل الدخول
| معلومات إضافية |
	•	عرض النسخة
	•	زر تسجيل الخروج

⸻

ملاحظات إضافية:
	•	عند تجاوز الحد المسموح به للمجاني (مثل حجم التنزيل أو عدد الملفات المخفية)، تظهر إشعارات تدعو المستخدم للاشتراك.
	•	سلة المحذوفات يمكن تفعيلها أو تعطيلها من هذا القسم فقط، وهي تعمل وفق النظام (الاحتفاظ 30 يومًا ثم الحذف).

⸻

الاعتماد على:

العنصر	الملف
اللغة	locale_provider.dart
الثيم	theme_provider.dart
الإشعارات	notification_service.dart
التخزين	storage_service.dart
الحماية	secure_storage_service.dart



⸻

ممتاز، ننتقل الآن إلى توثيق:

⸻

4. حساب المستخدم – account_view.dart

📌 الاسم:

حساب المستخدم – account_view.dart

⸻

🎯 الوظيفة:

يعرض معلومات المستخدم ويدير تسجيل الدخول والخروج، بالإضافة إلى حالة الاشتراك والخطة الحالية.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	العنوان: “حسابي”
	•	زر رجوع فقط
	2.	🧍‍♂️ معلومات الحساب (في الأعلى):
	•	صورة رمزية (Avatar)
	•	اسم المستخدم (أو “مستخدم غير مسجل”)
	•	البريد الإلكتروني (إذا كان مسجلًا)
	3.	🔐 خيارات الدخول / الخروج:
	•	زر “تسجيل الدخول”:
	•	يظهر إذا لم يكن المستخدم مسجلاً.
	•	يفتح شاشة تسجيل الدخول (اعتمادًا على Google/Apple).
	•	زر “تسجيل الخروج”:
	•	يظهر إذا كان المستخدم مسجلاً.
	•	يطلب تأكيد قبل تنفيذ العملية.
	4.	💎 معلومات الاشتراك:
	•	حالة الاشتراك الحالية:
	•	مشترك / غير مشترك
	•	الخطة الحالية (شهري / سنوي)
	•	تاريخ الانتهاء
	•	زر “الانتقال للاشتراك” (إذا لم يكن مشتركًا)

⸻

المميزات الإضافية:
	•	عند الضغط على صورة المستخدم:
	•	يمكن في المستقبل تعديل الصورة أو الانتقال لإعدادات الحساب المتقدمة.
	•	عند تسجيل الدخول، يتم مزامنة الاشتراك والسعة والبيانات مع الخادم.
	•	لا يمكن الوصول إلى خدمات المشترك (مثل رفع الملفات أو تحميل بجودة عالية) بدون تسجيل الدخول.

⸻

التنبيهات التلقائية:
	•	عند محاولة استخدام ميزة مدفوعة بدون تسجيل دخول:
	•	يظهر تنبيه ويُطلب تسجيل الدخول أولاً.
	•	إذا انتهى الاشتراك، تظهر رسالة تحفيزية للتجديد.

⸻

الاعتماد على:

العنصر	الملف
التوثيق	auth_service.dart
المستخدم	user_model.dart + user_provider.dart
حالة الاشتراك	subscription_model.dart + subscription_controller.dart
الأمان	secure_storage_service.dart
الواجهة	account_view.dart + account_controller.dart



⸻

رائع! الآن ننتقل إلى:

⸻

5. الاشتراكات – subscription_view.dart

📌 الاسم:

الاشتراكات – subscription_view.dart

⸻

🎯 الوظيفة:

تتيح للمستخدم الاطلاع على مزايا الاشتراك، ومقارنة الخطط، وإجراء عملية الشراء مباشرة من المتجر (Google Play / App Store).

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	العنوان: “الاشتراكات”
	•	زر رجوع فقط
	2.	📊 مقارنة المزايا (عرض جدول أو بطاقات):
	•	مقارنة بين:
	•	المستخدم المجاني
	•	المستخدم المشترك
	•	يتم عرض الفرق من خلال رموز (✔ / ✖) أو ألوان مميزة.
	3.	🛒 عروض الاشتراك (Cards):
	•	خطة شهرية
	•	خطة سنوية (سعر أقل لكل شهر)
	•	كل خطة تعرض:
	•	السعر
	•	اسم الخطة
	•	زر الاشتراك الآن
	•	عند الضغط على الزر:
	•	يتم تنفيذ الشراء مباشرة من المتجر.
	4.	✅ مزايا الاشتراك المدفوع (Premium):

الميزة	متاحة للمشترك
تحميل بجودة أعلى من 480p	✔
إزالة الإعلانات	✔
رفع إلى Google Drive تلقائيًا	✔
التحكم الكامل في الملفات المخفية	✔
أدوات الفيديو المتقدمة (قص / ضغط / تحويل)	✔
سعة الملفات المخفية أكبر (5GB أو 50 ملف)	✔
حجم تحميل يومي أعلى (غير محدود أو أعلى من 5GB)	✔
دعم الأولوية (قادم لاحقًا)	✔



⸻

⚠️ شروط وسياسات:
	•	الأسعار تُعرض بناءً على الدولة (تُحدث تلقائيًا).
	•	الاشتراك يتجدد تلقائيًا إلا إذا تم إلغاؤه.
	•	عملية الشراء تتم بشكل رسمي عبر in_app_purchase.

⸻

التحقق من الاشتراك:
	•	يتم التحقق من الاشتراك:
	•	عند تسجيل الدخول.
	•	عند فتح التطبيق.
	•	عند محاولة استخدام ميزة مميزة.
	•	عند انتهاء الاشتراك يتم إخفاء المميزات تلقائيًا.
	•	عند الضغط على “اشترك” بدون تسجيل دخول:
	•	يتم توجيه المستخدم إلى صفحة تسجيل الدخول أولاً.

⸻

الاعتماد على:

العنصر	الملف
الدفع	in_app_purchase
حالة الاشتراك	subscription_model.dart
إدارة الاشتراك	subscription_controller.dart
الحماية والتخزين	secure_storage_service.dart
مزامنة الحالة	user_provider.dart
الواجهة	subscription_view.dart



⸻

تمام، ننتقل الآن إلى:

⸻

6. الإعدادات – settings_view.dart

⸻

📌 الاسم:

الإعدادات – settings_view.dart

⸻

🎯 الوظيفة:

تمنح المستخدم إمكانية التحكم في خيارات التطبيق العامة مثل: المظهر، اللغة، الحماية، الإشعارات، سلة المحذوفات، وغيرها.

⸻

🧱 المكونات الرئيسية:
‏	1.	✅ AppBar علوي:
	•	العنوان: “الإعدادات”
	•	زر رجوع فقط

⸻

	2.	🎛️ خيارات الإعدادات:

الإعداد	الوصف	النوع
الوضع الليلي	تفعيل يدوي أو تلقائي (سويتشين متضادين)	Switch
اللغة	اختيار من بين (العربية / الإنجليزية)	قائمة منسدلة
الإشعارات	تفعيل/تعطيل الإشعارات المحلية	Switch
تشغيل الخلفية	تشغيل الملفات أثناء الخروج من التطبيق (مشترك فقط)	Switch
تفعيل سلة المحذوفات	الملفات تُنقل بدل الحذف، وتُمسح تلقائيًا بعد 30 يوم	Switch
الأمان	تفعيل بصمة / كلمة مرور (لاحقًا)	زر تنقل
التحقق من التحديثات	(قريبًا)	زر عرض إشعار فقط



⸻

🧠 تفاصيل سلوكية ذكية:
	•	عند تفعيل الوضع الليلي: يتم إلغاء التلقائي والعكس.
	•	اختيار اللغة يحفظ التفضيل في SecureStorageService.
	•	التشغيل في الخلفية مقيّد فقط للمشترك.
	•	تفعيل سلة المحذوفات يغيّر سلوك جميع عمليات الحذف في التطبيق.
	•	إعدادات الأمان لا تُعرض إلا بعد تسجيل الدخول.

⸻

🛡️ الأمان والخصوصية:
	•	عند الدخول إلى قسم “الأمان”، يتم فتح صفحة مخصصة.
	•	يمكن تفعيل القفل بالبصمة أو كلمة مرور (قريبًا).
	•	يتم حفظ التفضيلات بشكل مشفر.

⸻

الاعتماد على:

العنصر	الملف
اللغة	translation_service.dart
التيم	theme_provider.dart
الإعدادات العامة	settings_view.dart, setting_controller.dart
الإشعارات	notification_service.dart
الوضع الليلي	app_theme.dart, theme_provider.dart
التخزين الآمن	secure_storage_service.dart



⸻

رائع، نكمل الآن مع:

⸻

7. تواصل معنا – contact_view.dart (جزء من more_view.dart)

⸻

📌 الاسم:

تواصل معنا – زر داخل more_view.dart يفتح صفحة أو نافذة توضيحية.

⸻

🎯 الوظيفة:

إظهار وسيلة تواصل رمزية للمستخدم عند الحاجة، لكن بدون دعم فعلي، فقط عرض الشكل والواجهة.

⸻

🧱 المكونات الرئيسية:
	1.	زر داخل قائمة المزيد:
	•	الاسم: “تواصل معنا”
	•	الأيقونة: Icons.support_agent
	•	عند الضغط عليه يفتح صفحة/حوار.
	2.	محتوى صفحة التواصل:
	•	عنوان: “الدعم الفني”
	•	وصف بسيط: “لملاحظاتك واقتراحاتك يمكنك التواصل معنا عبر البريد التالي:”
	•	البريد: support@maard.app
(يُعرض كنص قابل للنسخ فقط)
	•	لا توجد أي وظائف إرسال فعلية.

⸻

✉️ سلوكيات إضافية:
	•	عند الضغط على البريد يتم نسخه تلقائيًا (مع إشعار SnackBar مثلاً: “تم نسخ البريد”).
	•	لا يتم فتح تطبيق بريد أو إرسال فعلي.

⸻

ملاحظات:
	•	هذه الصفحة/النافذة لا تتطلب اتصال فعلي أو إرسال بيانات.
	•	هي فقط واجهة وهمية لعرض جهة دعم رمزية.
	•	الدعم الفعلي غير موجود ضمن التطبيق.

⸻

جميل، ننتقل الآن إلى:

⸻

8. سياسة الخصوصية – privacy_policy_view.dart (ضمن more_view.dart)

⸻

📌 الاسم:

سياسة الخصوصية – رابط في قائمة المزيد يفتح صفحة تحتوي على نص السياسة.

⸻

🎯 الوظيفة:

عرض نص سياسة الخصوصية للمستخدم بشكل مبسط ومتاح دائمًا داخل التطبيق، من دون الحاجة إلى اتصال مباشر بالإنترنت.

⸻

📦 طريقة العرض:
	•	عند الضغط على “سياسة الخصوصية” يتم فتح صفحة جديدة (أو Dialog).
	•	يتم تحميل السياسة من رابط ثابت:

‏https://mard-api-1.onrender.com/privacy_policy.html


	•	يتم عرض النص عبر WebView أو SelectableText بعد تحميله.

⸻

📃 مكونات الصفحة:
‏	1.	AppBar علوي:
	•	عنوان: “سياسة الخصوصية”
	•	زر رجوع.
	2.	المحتوى:
	•	عرض محتوى السياسة من الرابط.
	•	في حالة عدم توفر الاتصال: عرض رسالة “تعذر تحميل السياسة”.

⸻

ملاحظات فنية:
	•	يجب دعم تحميل الرابط باستخدام http أو flutter_inappwebview أو url_launcher.
	•	الخيار الأفضل: استخدام WebView مع تحكم بسيط.
	•	يمكن مستقبلاً وضع نسخة HTML مدمجة ضمن assets/lang/privacy_policy.html كنسخة احتياطية.

⸻

ملاحظة:

السياسة محفوظة باسم الشركة:
‏© 2025 Mard Studio

⸻

ممتاز، نكمل الآن مع:

⸻

9. تقييم التطبيق – “rate_app” داخل more_view.dart

⸻

📌 الاسم:

تقييم التطبيق – خيار في قائمة المزيد.

⸻

🎯 الوظيفة:

توجيه المستخدم مباشرة إلى صفحة تقييم التطبيق على متجر Google Play أو App Store.

⸻

⚙️ السلوك عند الضغط:
	•	يتم فتح صفحة التطبيق في المتجر تلقائيًا.
	•	يتم تحديد المتجر المناسب حسب النظام (Android أو iOS).
	•	لا يُطلب من المستخدم تسجيل الدخول أو تنفيذ خطوات إضافية.

⸻

🔗 الروابط الافتراضية (يتم تحديثها لاحقًا):
‏	•	Android:

‏https://play.google.com/store/apps/details?id=com.mard.app


‏	•	iOS:

‏https://apps.apple.com/app/idYOUR_APP_ID



⸻

📦 ملاحظات فنية:
	•	يستخدم url_launcher لفتح الرابط الخارجي.
	•	يتم فحص النظام باستخدام:

‏Platform.isAndroid || Platform.isIOS


	•	يمكن لاحقًا دعم التقييم الداخلي باستخدام حزمة مثل in_app_review.

⸻

🛡️ ملاحظات حماية:
	•	لا يتم تخزين أي بيانات من التقييم.
	•	العملية تتم بالكامل عبر المتجر.

⸻

ممتاز، ننتقل الآن إلى:

⸻

10. مشاركة التطبيق – “share_app” داخل more_view.dart

⸻

📌 الاسم:

مشاركة التطبيق – خيار في قائمة المزيد.

⸻

🎯 الوظيفة:

يسمح للمستخدم بمشاركة رابط تحميل تطبيق مارد مع الآخرين عبر تطبيقات التواصل المختلفة (واتساب، تيليجرام، تويتر، إلخ…).

⸻

⚙️ السلوك عند الضغط:
	•	يتم فتح واجهة المشاركة الافتراضية في الجهاز.
	•	يتم مشاركة نص يحتوي على:
	•	اسم التطبيق
	•	وصف بسيط
	•	رابط تحميل التطبيق من المتجر

⸻

📄 مثال النص المشترك:

جرب تطبيق مارد لتحميل الفيديوهات وإدارتها بذكاء وسرعة!

حمله الآن:
‏https://play.google.com/store/apps/details?id=com.mard.app



⸻

📦 ملاحظات فنية:
	•	يعتمد على حزمة share_plus.
	•	يتم تحديد الرابط تلقائيًا بناءً على النظام:
‏	•	Android → Google Play
‏	•	iOS → App Store

‏await Share.share("جرب تطبيق مارد لتحميل الفيديوهات...\nhttps://play.google.com/store/apps/details?id=com.mard.app");



⸻

🛡️ الخصوصية:
	•	لا يتم تخزين أو تعقب عملية المشاركة.
	•	يتم تشغيل الميزة محليًا بالكامل.

⸻

ممتاز، ننتقل الآن إلى:

⸻

11. حول التطبيق – “about_app” داخل more_view.dart

⸻

📌 الاسم:

حول التطبيق – قسم تعريفي داخل “المزيد”.

⸻

🎯 الوظيفة:

يعرض للمستخدم معلومات تفصيلية حول تطبيق مارد مثل الإصدار، المميزات الأساسية، وتفاصيل فريق التطوير.

⸻

🧱 محتويات الصفحة:
	1.	شعار التطبيق واسم التطبيق
	•	يظهر في أعلى الصفحة.
	2.	رقم الإصدار
	•	يتم الحصول عليه تلقائيًا من pubspec.yaml.
	3.	وصف تعريفي:
	•	يشرح باختصار ما يقوم به التطبيق.
	•	مثال:

تطبيق مارد هو أداة ذكية ومتعددة الوظائف لتحميل الفيديوهات، تحويلها، تشغيلها، وإدارتها بخصوصية وكفاءة.


	4.	فريق التطوير:
	•	يعرض اسم الجهة المطورة:

‏Mard Studio © 2025


	5.	رابط سياسة الخصوصية
	•	يتم توجيه المستخدم إلى https://mard-api-1.onrender.com/privacy_policy.html
	6.	رابط مراجعة التطبيق
	•	زر يفتح صفحة التطبيق في المتجر لتقييمه.

⸻

⚙️ ملاحظات برمجية:
	•	الاعتماد على مكتبة package_info_plus لجلب رقم الإصدار.
	•	يجب توجيه المستخدم إلى روابط المتجر بناءً على نظام التشغيل.
	•	التصميم بسيط ونظيف، متوافق مع الوضع الليلي.

⸻

📱 مثال عرض:

مـارد - v1.0.0+1
تطبيق ذكي لتحميل وإدارة الفيديوهات والصوتيات.

المطور: Mard Studio © 2025
[سياسة الخصوصية] [تقييم التطبيق]



⸻

ممتاز، ننتقل الآن إلى:

⸻

12. سياسة الخصوصية – “privacy_policy” داخل more_view.dart

⸻

📌 الاسم:

سياسة الخصوصية – صفحة قانونية ضمن قسم “المزيد”.

⸻

🎯 الوظيفة:

عرض سياسة الخصوصية الكاملة للمستخدمين بشكل رسمي، بما يتوافق مع شروط Google Play وApple App Store.

⸻

🧱 محتويات القسم:
	1.	عنوان الصفحة:
	•	“سياسة الخصوصية”
	2.	المحتوى:
	•	يتم تحميله من الإنترنت بصيغة HTML أو نص عادي.
	•	المصدر المعتمد:

‏https://mard-api-1.onrender.com/privacy_policy.html


	3.	طريقة العرض:
	•	باستخدام WebView أو SelectableText إذا تم تحميل النص.
	•	واجهة بسيطة قابلة للقراءة.
	4.	دعم اللغات:
	•	يُفضّل أن تكون السياسة متوفرة باللغتين (العربية / الإنجليزية) حسب لغة المستخدم.

⸻

⚙️ ملاحظات تقنية:
	•	يتم تحميل المحتوى عند الدخول على الصفحة.
	•	في حال عدم وجود اتصال إنترنت، يتم عرض رسالة تنبيه.
	•	لا يُسمح بتعديل المحتوى من داخل التطبيق.

⸻

✍️ محتوى السياسة (اختصار):
	•	لا يتم جمع بيانات شخصية بدون موافقة المستخدم.
	•	يتم حفظ الملفات داخليًا ولا تُشارك مع أي طرف ثالث.
	•	يتم استخدام Google AdMob لعرض الإعلانات (للمستخدم المجاني).
	•	الاشتراكات تُدار من خلال المتجر فقط.
	•	رفع الملفات إلى Google Drive يتم بموافقة المستخدم.

⸻

أكيد! الجزء العملي في تطبيق مـارد هو كل ما يحدث خلف الكواليس من تفاعل المستخدم مع الواجهات، وصولًا إلى تنفيذ الخدمات والعمليات فعليًا. خليني أشرح لك الجزء العملي بشكل شامل ومترابط حسب البنية اللي اشتغلنا عليها:

⸻

✅ الجزء العملي في تطبيق “مـارد”

1. تحميل الفيديوهات والروابط

الخطوات:
	•	المستخدم يدخل رابط الفيديو في الشاشة الرئيسية.
	•	يتم فحص الرابط:
	•	إذا يدعمه التطبيق محليًا → يتم التحميل داخليًا.
	•	إذا كان يحتاج خادم (مثل YouTube) → يتم إرساله للسيرفر https://mard-api.onrender.com.
	•	عند نجاح التحليل:
	•	تظهر نافذة منبثقة فيها:
	•	اسم الفيديو
	•	الجودة
	•	الحجم
	•	خيار “تحميل صوت فقط”
	•	عند اختيار الجودة → يبدأ التحميل وتُخزن البيانات في التنزيلات.

الأدوات والخدمات:
‏	•	HomeController
‏	•	DownloadService
‏	•	YoutubeService
‏	•	ConversionService (لتحويل الصوت)
‏	•	AdService (لعرض إعلان بعد التحميل)

⸻

2. إدارة الملفات (ملفاتي)

الوظائف:
	•	عرض الملفات المحملة فقط (التي اكتملت).
	•	تشغيل الملفات (صوت / فيديو).
	•	مشاركة الملفات.
	•	رفع الملفات إلى Google Drive.
	•	إخفاء الملفات → تنتقل إلى الملفات المخفية.
	•	حذف → إلى سلة المحذوفات.

الخدمات المرتبطة:
‏	•	FileService
‏	•	HiddenFileService
‏	•	UploadService
‏	•	TrashService
‏	•	StorageService (للتخزين الداخلي)
‏	•	MediaPlayerService

⸻

3. الملفات المخفية
	•	يمكن فقط عرضها داخل التطبيق.
	•	يتم تشفير مسارها ونقلها لمجلد خاص.
	•	لا يمكن تشغيلها في الخلفية.
	•	تتطلب اشتراك عند تجاوز الحد المسموح للمستخدم المجاني.

⸻

4. سلة المحذوفات
	•	عند الحذف، يُنقل الملف إلى مجلد trash/.
	•	يبقى الملف 30 يومًا ثم يُحذف تلقائيًا.
	•	يمكن للمستخدم حذف الملف يدويًا نهائيًا.

⸻

5. الاشتراكات
	•	المستخدم المجاني:
	•	تحميل 5GB يوميًا فقط.
	•	جودة تصل إلى 480p.
	•	إعلانات تظهر بعد التحميل.
	•	عدد ملفات مخفية محدود.
	•	المشترك:
	•	جودة عالية
	•	تحميل غير محدود
	•	لا إعلانات
	•	مساحة أكبر للملفات المخفية
	•	ميزات حصرية مثل “تحرير الفيديو”

خدمات مرتبطة:
‏	•	SubscriptionService
‏	•	UserController
‏	•	SecureStorageService

⸻

6. الإعدادات
	•	الوضع الليلي والتلقائي
	•	اللغة (عربي/إنجليزي)
	•	تفعيل/تعطيل التشغيل في الخلفية
	•	سلة المحذوفات: تمكين/تعطيل
	•	التحقق من التحديثات لاحقًا

⸻

7. الإشعارات
	•	عند اكتمال تحميل أو تحويل أو رفع → يظهر إشعار محلي.
	•	يتم جدولة بعض الإشعارات (اختياري).
	•	يعتمد على NotificationService.

⸻

8. الإعلانات
	•	تظهر بعد التحميل للمستخدم المجاني فقط.
	•	إعلانات بينية (Interstitial) يتم تحميلها تلقائيًا.
	•	تستخدم google_mobile_ads.

⸻

9. التشغيل في الخلفية
	•	الملفات المحملة يمكن تشغيلها في الخلفية.
	•	باستخدام just_audio + audio_session.

⸻

10. المتصفح المدمج
	•	عند فتح المتصفح يتم تحميل الموقع داخل WebView.
	•	يتم اكتشاف الفيديوهات تلقائيًا.
	•	عند الاكتشاف:
	•	تظهر نافذة فيها خيارات الجودة والتحويل والتحميل.
	•	إذا فشل الاكتشاف → يتم إرسال الرابط للسيرفر.

⸻

ممتاز! خليني أشرح لك الآن تسلسل الأحداث العملي الكامل في تطبيق “مـارد” من لحظة الضغط على زر التحميل إلى إتمام العملية، بشكل دقيق وسهل الفهم:

⸻

✅ تسلسل الأحداث عند الضغط على زر “تحميل” في الشاشة الرئيسية

1. المستخدم يدخل رابط في حقل الإدخال
	•	الرابط يُخزن داخل controller.linkController.text.

⸻

2. المستخدم يضغط على زر “تحميل”
	•	يتم استدعاء:
‏controller.processLink();

⸻

3. التحقق من نوع الرابط داخليًا
	•	الدالة processLink() تستدعي:

‏final info = await DownloadService.extractVideoInfo(link);


	•	هذا يحاول تحليل الرابط داخليًا:
	•	إذا كان مدعوم داخليًا → يُستخرج اسم الفيديو، الجودة، الصيغ.
	•	إذا فشل التحليل الداخلي → يتم إرسال الرابط إلى الخادم عبر YoutubeService.getVideoInfo(link).

⸻

4. نجاح التحليل (داخلي أو من السيرفر)
	•	يتم تخزين معلومات الفيديو في:
‏controller.videoInfo.value = info;
	•	تظهر تلقائيًا نافذة منبثقة (BottomSheet أو Dialog) تحتوي على:
	•	اسم الفيديو
	•	صورة مصغرة
	•	الصيغ المتاحة
	•	الجودة
	•	زر: تحميل الفيديو
	•	زر: تحويل إلى صوت فقط

⸻

5. المستخدم يختار جودة / صيغة
	•	عند الضغط على زر التحميل:
	•	يتم استدعاء:

‏DownloadService.startDownload(info.selectedQualityUrl);



⸻

6. تحميل الملف
	•	الملف يبدأ في التحميل داخل مجلد downloads/.
	•	تظهر البطاقة في شاشة “التنزيلات”.
	•	يظهر شريط التقدم (ProgressBar).
	•	عند اكتمال التحميل:
	•	يتم حفظ الملف نهائيًا.
	•	يتم نقله إلى مجلد “ملفاتي”.
	•	إذا تم تحديد “صوت فقط”:
	•	يستدعى ConversionService.convertVideoToMp3()

⸻

7. عرض إعلان (للمجاني)
	•	بعد اكتمال التحميل:
	•	يتم استدعاء:
‏AdService.loadAndShowInterstitialAd(isPremium: false);

⸻

8. عرض إشعار
	•	يتم عرض إشعار باستخدام:

‏NotificationService.showNotification(
‏  id: 1,
‏  title: "اكتمل التحميل",
‏  body: "تم حفظ الفيديو في ملفاتي.",
);



⸻

9. تشغيل الملف
	•	من شاشة “ملفاتي”، المستخدم يضغط على الملف:
	•	يتم تشغيل الفيديو أو الصوت داخليًا باستخدام MediaPlayerService.

⸻

تمام، خلينا نكمل الآن تسلسل الأحداث العملي عند التحميل من شاشة المتصفح BrowserView خطوة بخطوة:

⸻

✅ تسلسل الأحداث عند التصفح والتحميل من داخل المتصفح

1. المستخدم يضغط على الزر العائم من الشاشة الرئيسية
	•	الزر ينقل إلى BrowserView.

‏Get.toNamed(AppRoutes.browser);



⸻

2. شاشة المتصفح تفتح WebView
	•	يتم تحميل الصفحة الافتراضية أو آخر صفحة زارها المستخدم.
	•	المستخدم يبدأ بالتصفح بشكل عادي (مثلاً يفتح TikTok أو Twitter أو أي موقع مدعوم).

⸻

3. مراقبة الروابط داخل WebView
	•	يتم تشغيل المراقبة من خلال onLoadStop أو onPageFinished.
	•	يتم تحليل الصفحة تلقائيًا لاكتشاف وجود فيديو:

‏BrowserController.checkForVideoInPage();



⸻

4. في حال تم اكتشاف فيديو داخل الصفحة
	•	يتم عرض نافذة منبثقة (BottomSheet) تحتوي على:
	•	عنوان الفيديو
	•	الصورة المصغرة
	•	الجودة المتاحة
	•	الحجم
	•	زر تحميل الفيديو
	•	زر تحميل الصوت فقط (MP3)

⸻

5. في حال لم يتم تحليل الصفحة بنجاح داخليًا
	•	يتم إرسال الرابط الحالي للسيرفر:

‏YoutubeService.getVideoInfo(currentUrl);

	•	ويتم انتظار الرد لتحليل الصفحة خارجيًا.

⸻

6. المستخدم يختار التحميل
	•	عند الضغط على زر التحميل:
	•	يتم استدعاء:

‏DownloadService.startDownload(selectedQualityUrl);

	•	أما إذا تم اختيار “تحميل كصوت فقط”:
	•	يتم تحميل الفيديو أولًا، ثم يُحول باستخدام:

‏ConversionService.convertVideoToMp3();



⸻

7. التنزيل يُعرض في شاشة “التنزيلات”
	•	يظهر شريط التقدم، الوقت المتبقي، السرعة، وزر إلغاء / إيقاف مؤقت.
	•	عند اكتمال التحميل:
	•	يُنقل الملف إلى “ملفاتي”.
	•	يظهر إشعار.
	•	يتم عرض إعلان (للمجاني فقط).

⸻

8. الملف يظهر في شاشة “ملفاتي”
	•	يظهر بكافة التفاصيل (اسم، صيغة، وقت، الحجم).
	•	يمكن تشغيله داخليًا أو رفعه إلى Google Drive أو إخفاؤه.

⸻

9. في حال فشل التحليل
	•	يتم عرض رسالة تنبيه للمستخدم:

“لم يتم اكتشاف أي محتوى قابل للتحميل في الصفحة.”

⸻

جميل، نكمل الآن بالشرح العملي الكامل لـ شاشة “ملفاتي” – MyFilesView وما يحدث في الخلفية عند التفاعل معها:

⸻

✅ التسلسل العملي في شاشة ملفاتي

1. عند فتح الشاشة
	•	يتم استدعاء FileController تلقائيًا.
	•	يبدأ بجلب كل الملفات الموجودة في مجلد التنزيلات الداخلي:

‏FileController.loadFiles();

	•	يتم فلترة الملفات بحيث:
	•	تظهر فقط الملفات التي تم تحميلها بنجاح.
	•	لا تظهر الملفات المخفية.
	•	لا تظهر الملفات في سلة المحذوفات.

⸻

2. عرض الملفات
	•	كل ملف يظهر كمكون تفاعلي يحتوي على:
	•	الاسم
	•	النوع (صوت/فيديو/عام)
	•	الحجم
	•	تاريخ الإضافة
	•	الحالة (مرفوع أم لا)

⸻

3. عند الضغط على ملف
	•	تظهر قائمة خيارات مثل:
	•	تشغيل (يفتح مشغل داخلي)
	•	مشاركة
	•	رفع إلى Google Drive
	•	تحويل إلى صوت (إذا كان فيديو)
	•	إخفاء
	•	حذف

⸻

4. تشغيل الملف
	•	إذا كان فيديو أو صوت:
	•	يتم استخدام MediaPlayerService.play(path) لتشغيله داخليًا.
	•	يتم دعم التشغيل في الخلفية للمستخدمين المشتركين فقط.

⸻

5. مشاركة الملف
	•	يتم فتح نافذة مشاركة باستخدام Share.shareFiles(...).

⸻

6. رفع الملف إلى Google Drive
	•	يتم التحقق من تسجيل الدخول أولاً.
	•	ثم يتم استدعاء:

‏UploadService.uploadToDrive(file);

	•	تُعرض حالة الرفع (جارٍ – تم – فشل).

⸻

7. تحويل إلى صوت
	•	إذا تم اختيار “تحويل إلى MP3”:
	•	يتم استخدام FFmpeg داخليًا لتحويل الفيديو إلى صوت:

‏ConversionService.convertVideoToMp3(file);

	•	يظهر الملف الجديد مباشرة في القائمة.

⸻

8. إخفاء الملف
	•	يتم نقله إلى مجلد “المخفي”:

‏HiddenFileService.hide(file);

	•	ويتم تحديث القائمة بعد نقله مباشرة.

⸻

9. حذف الملف
	•	لا يتم حذفه نهائيًا.
	•	يتم نقله إلى سلة المحذوفات:

‏StorageService.moveToTrash(file);

	•	يبقى الملف في سلة المحذوفات لمدة 30 يومًا.

⸻

10. سلة المحذوفات
	•	هي عبارة عن مجلد خاص، يظهر كعنصر ثابت في أعلى الصفحة.
	•	يحتوي على كل الملفات المحذوفة مؤخرًا.
	•	المستخدم يمكنه:
	•	استرجاعها
	•	أو حذفها نهائيًا.

⸻

تمام، نبدأ الآن بالشرح العملي التفصيلي لخدمة Google Drive داخل تطبيق مـارد:

⸻

☁️ الرفع إلى Google Drive

1. قبل بدء الرفع
	•	يتم التأكد أولًا من أن المستخدم مسجل دخوله بحساب Google.
	•	يتم ذلك باستخدام مكتبة OAuth من googleapis_auth أو عبر Firebase.
	•	إذا لم يكن مسجلًا، يتم توجيهه لشاشة تسجيل الدخول.
	•	بعد تسجيل الدخول يتم حفظ التوكن في SecureStorageService.

⸻

2. عند اختيار “رفع إلى Google Drive”
	•	المستخدم يضغط على الملف في “ملفاتي”، ثم يختار “رفع إلى السحابة”.
	•	يتم تشغيل:

‏UploadService.uploadToDrive(File file);



⸻

3. خطوات داخل UploadService:

✅ 1. التأكد من التوكن:

‏final token = await SecureStorageService.read("google_token");

	•	إذا كان التوكن غير موجود → يعاد توجيه المستخدم لتسجيل الدخول.

✅ 2. تجهيز الطلب:
	•	يتم تحديد:
	•	اسم الملف.
	•	المجلد على Google Drive (يمكن يكون مجلد افتراضي أو مخصص).

✅ 3. إرسال الملف:
	•	يتم استخدام http.MultipartRequest أو مكتبة Google API:

‏var response = await driveApi.files.create(
‏  driveFile,
‏  uploadMedia: media,
);

✅ 4. عند النجاح:
	•	يتم تحديث حالة الملف محليًا في التطبيق.
	•	تظهر أيقونة ✅ بجانب الملف تدل على أنه مرفوع.

⸻

4. الحالات المحتملة أثناء الرفع:

الحالة	التفاعل
✅ تم الرفع بنجاح	تظهر رسالة نجاح + أيقونة ✅
❌ فشل الرفع	تظهر رسالة خطأ + إمكانية المحاولة لاحقًا
⏳ جاري الرفع	يظهر مؤشر تحميل (Progress Indicator)



⸻

5. مميزات المشتركين فقط:
	•	ميزة رفع الملفات إلى Google Drive حصرية للمستخدمين المشتركين فقط.
	•	إذا كان المستخدم غير مشترك، تظهر له نافذة الاشتراك.

⸻

رائع، نكمل الآن بشرح القسم العملي الخاص بـ الملفات المخفية في تطبيق مـارد:

⸻

🕵️‍♂️ الملفات المخفية – Hidden Files

1. الغرض من الخدمة
	•	إخفاء ملفات المستخدم الحساسة داخل التطبيق فقط.
	•	الملفات لا تظهر في “ملفاتي” أو في مدير ملفات الجهاز أو في الاستوديو.
	•	لا يمكن فتحها إلا من داخل التطبيق، وبإذن مسبق من المستخدم.

⸻

2. آلية الإخفاء

✅ عند اختيار “إخفاء”:
	•	يتم الضغط على أيقونة الخيارات بجانب الملف داخل “ملفاتي”.
	•	يتم اختيار:

إخفاء → HiddenFileService.hide(file);

✅ ما يحدث برمجيًا:
	1.	الملف يُنقل من مجلد downloads/ إلى مجلد hidden/ داخل appDirectory.
	2.	يتم تحديث الحالة في قاعدة البيانات المحلية أو الملف المسجل للملفات (مثل Hive أو SharedPreferences).
	3.	يتم حذف أي ظهور له من “ملفاتي”.

⸻

3. الدخول إلى “الملفات المخفية”
	•	يتم من قائمة “المزيد”.
	•	الشاشة اسمها: HiddenFilesView
	•	يتم فحص حالة الاشتراك:
	•	إذا كان المستخدم غير مشترك:
	•	يُسمح له بتخزين عدد محدود من الملفات (حتى 50 ملف أو 5GB).
	•	بعد الوصول للحد → يظهر تنبيه وتحفيز للترقية.
	•	إذا كان مشترك → لا قيود.

✅ واجهة الشاشة:
	•	قائمة بالملفات المخفية:
	•	اسم الملف
	•	نوعه (صوت/فيديو/ملف آخر)
	•	زر “إظهار الملف”
	•	زر “حذف” أو “نقل إلى سلة المحذوفات”

⸻

4. الحماية (لاحقًا):
	•	يتم حماية القسم بكلمة مرور أو بصمة.
	•	يتم تفعيلها من الإعدادات:
‏	•	Toggle باسم: “قفل الملفات المخفية”
	•	عند التفعيل: يتم طلب المصادقة عند كل دخول.

⸻

5. عند الضغط على “إظهار الملف”
	•	يتم استدعاء:

‏HiddenFileService.unhide(file);

	•	يتم نقل الملف من مجلد hidden/ إلى downloads/ أو my_files/
	•	يتم تحديث حالته ويظهر مرة أخرى في “ملفاتي”.

⸻

جميل! ننتقل الآن لشرح شاشة التنزيلات – DownloadsView بشكل شامل من الناحية العملية والتقنية:

⸻

📥 شاشة التنزيلات – DownloadsView

1. الغرض من الشاشة
	•	عرض كل الملفات التي قيد التحميل حاليًا.
	•	إدارة التنزيل (إيقاف، استئناف، إلغاء).
	•	لا تحتوي على سجل للملفات المكتملة (لأنها تنتقل تلقائيًا إلى “ملفاتي”).

⸻

2. آلية العمل

✅ عند بدء التحميل:
	•	يتم تمرير الرابط إلى DownloadService.download(url).
	•	يتم إنشاء مهمة تحميل باستخدام dio مع CancelToken للتحكم.
	•	الملف يُحمّل في مجلد downloads/ المؤقت.

✅ خلال التحميل:
	•	يتم تتبع التقدم:

‏onReceiveProgress: (received, total) {
‏  final percent = (received / total * 100).toInt();
‏  controller.updateProgress(fileId, percent);
}

	•	يتم عرض كل ملف داخل:
	•	بطاقة تحتوي على:
	•	اسم الملف
	•	شريط تقدم (Progress bar)
	•	سرعة التحميل
	•	الوقت المتبقي (تقديري)
	•	أزرار:
	•	“إيقاف مؤقت”
	•	“استئناف”
	•	“إلغاء”

⸻

3. عند انتهاء التحميل
	•	يتم نقل الملف إلى مجلد “ملفاتي” رسميًا.
	•	يتم حذفه من شاشة التنزيلات.
	•	يظهر إشعار باستخدام NotificationService.showNotification().

⸻

4. الخيارات المتاحة على كل ملف

الزر	الوظيفة
▶️ استئناف	يعيد تحميل الملف المتوقف
⏸️ إيقاف	يوقف مؤقتًا التحميل
❌ إلغاء	يوقف التحميل ويزيل الملف المؤقت

لا يوجد سجل للتحميلات الفاشلة — الملفات التي تفشل تُزال فورًا، ويمكن إعادة محاولة التحميل من جديد.

⸻

5. إعلانات بعد التحميل (إذا كان غير مشترك)
	•	بعد انتهاء كل تحميل → يظهر إعلان بيني باستخدام:

‏AdService.loadAndShowInterstitialAd(isPremium: user.isPremium);



⸻

6. قيود الحساب المجاني
	•	الحد اليومي للتحميل: 5GB.
	•	يتم فحص الحجم المتبقي قبل البدء.
	•	إذا تجاوز الحد:
	•	يظهر للمستخدم تنبيه وتحفيز للترقية (أو يتم نقله إلى شاشة الاشتراك تلقائيًا).

⸻

7. واجهة الاستخدام
	•	تصميم نظيف وسلس.
	•	الخلفية نفسها كالمعتاد (طبيعية).
	•	العناصر ذات زوايا ناعمة.
	•	التنقل سهل بين التنزيلات و”ملفاتي” باستخدام الشريط السفلي.

⸻

ممتاز! نبدأ الآن بتوثيق شاشة ملفاتي (My Files) بشكل عملي وفني حسب ما اعتمدناه في المشروع.

⸻

شاشة ملفاتي – MyFilesView (my_files_view.dart)

1. الوظيفة الأساسية:
	•	عرض جميع الملفات التي تم تحميلها بنجاح.
	•	يمكن تشغيل، مشاركة، حذف، إعادة تسمية، إخفاء، ضغط أو رفع الملفات إلى Google Drive.
	•	الملفات تُعرض داخل مجلدات.
	•	الملفات التي تم حذفها تنتقل إلى “سلة المحذوفات” بدل الحذف النهائي.

⸻

2. أهم الخصائص والمكونات:

أ. الهيكل العام:
‏	•	AppBar ثابت بعنوان: “ملفاتي”.
‏	•	GridView أو ListView لعرض الملفات والمجلدات.
	•	زر عائم لإضافة مجلد أو رفع ملف.
	•	قسم ثابت في الأعلى يحتوي على:
	•	زر “كل الملفات”
	•	المجلدات المُضافة من المستخدم (داخل التطبيق)
	•	سلة المحذوفات (كعنصر دائم في الأسفل)

⸻

ب. عرض الملف (File Card):

كل ملف يُعرض داخل كرت فيه:
	•	أيقونة نوع الملف (فيديو / صوت / PDF…).
	•	اسم الملف.
	•	الحجم.
	•	التاريخ.
	•	المدة (للصوتيات والفيديو).
	•	زر خيارات (ثلاث نقاط) يفتح قائمة عمليات:
	•	تشغيل
	•	تحويل إلى صوت
	•	ضغط
	•	إخفاء
	•	مشاركة
	•	رفع إلى Google Drive
	•	إعادة التسمية
	•	حذف (إلى السلة)

⸻

ج. التحكم بالمجلدات:
	•	إنشاء مجلد جديد داخل “ملفاتي”.
	•	نقل ملف إلى مجلد.
	•	حذف أو إعادة تسمية مجلد.
	•	كل مجلد يحتوي نفس الخصائص (عرض ملفات، خيارات لكل ملف).

⸻

3. الربط البرمجي:

المصدر:
	•	الملفات تُعرض من StorageService و FileController.

التخزين:
	•	يتم تخزين المسارات والبيانات في قاعدة محلية (Hive أو SharedPreferences) حسب حجم البيانات.

الاشتراك:
	•	بعض الميزات مقيدة بالمشترك:
	•	إخفاء عدد غير محدود من الملفات.
	•	ضغط الملفات.
	•	التحويل إلى صوت بجودة عالية.

⸻

4. التشغيل في الخلفية:
	•	يدعم تشغيل الصوت والفيديو من داخل التطبيق فقط.
	•	لا يُسمح بتشغيل الملفات من خارج التطبيق.

⸻

5. التوافق مع الثيم:
	•	التصميم متجاوب مع الوضع الليلي.
	•	خلفية الشاشة نفسها مثل باقي الصفحات.
	•	الخط الافتراضي والخفيف المستخدم في المشروع.

⸻

6. واجهة المستخدم التفاعلية:
	•	سحب لليسار/اليمين لحذف أو نقل.
	•	دعم الضغط المطول لتحديد ملفات متعددة.
	•	دعم فرز الملفات (تاريخ – الحجم – النوع…).

⸻

7. خدمات مرتبطة:
‏	•	FileService
‏	•	UploadService
‏	•	HiddenFileService
‏	•	TrashService
‏	•	ConversionService
‏	•	CompressionHelper (لاحقًا)

⸻

جميل، ننتقل الآن إلى توثيق الشاشة التالية وهي:

⸻

شاشة الملفات المخفية – HiddenFilesView (hidden_files_view.dart)

1. الوظيفة الأساسية:
	•	عرض الملفات التي قام المستخدم بإخفائها يدويًا من “ملفاتي”.
	•	هذه الملفات لا تظهر في أي مكان آخر داخل التطبيق إلا من خلال هذه الشاشة.
	•	لا يمكن الوصول لها من مدير ملفات الهاتف أو التطبيقات الخارجية.
	•	تتطلب اشتراك لتوسيع المساحة المخفية.

⸻

2. الخصائص والمكونات:

أ. الهيكل العام:
‏	•	AppBar بعنوان: “الملفات المخفية”.
	•	عرض الملفات بشكل قائمة أو شبكة (نفس تصميم ملفاتي).
	•	زر بحث لتصفية الملفات.
	•	مؤشر استخدام المساحة المحددة للمجاني (مثلاً: 50 ملف أو 5GB).
	•	رسالة تظهر في الأعلى في حال اقتراب أو تجاوز الحد الأقصى للمجاني.

⸻

ب. عرض كل ملف (File Card):
	•	أيقونة نوع الملف (صوت، فيديو…).
	•	اسم الملف.
	•	التاريخ.
	•	الحجم.
	•	زر “الخيارات” الذي يحتوي على:
	•	تشغيل داخلي فقط
	•	إظهار (نقل إلى “ملفاتي”)
	•	مشاركة
	•	حذف (إلى سلة المحذوفات)
	•	ضغط الملف
	•	تحويل إلى صوت (في حال فيديو)

⸻

ج. الأمان والخصوصية:
	•	هذه الشاشة محمية (لاحقًا) بكلمة مرور أو بصمة.
	•	لا تُعرض الصور أو الفيديوهات المصغّرة علنًا (تظهر كأيقونة ثابتة فقط).
	•	لا يمكن التقاط لقطات شاشة منها.

⸻

3. الاشتراك والتقييد:

للمستخدم المجاني:
	•	يمكنه إخفاء حتى 5GB أو 50 ملفًا فقط.
	•	تظهر له رسالة “تجاوزت الحد” ويُطلب الاشتراك في الباقة المدفوعة.

للمشترك:
	•	مساحة غير محدودة.
	•	دعم إضافي لخدمات مثل ضغط وتحويل الملفات.

⸻

4. الربط البرمجي:
	•	مصدر البيانات: HiddenFileService.
	•	التحكم: HiddenController.
	•	حفظ الإعدادات والوصول يتم من خلال SecureStorageService.

⸻

5. التصميم والسمات:
	•	متسق مع ثيم التطبيق (خلفية طبيعية، وضع ليلي).
	•	النصوص والرموز نفس أسلوب “ملفاتي”.
	•	سلة المحذوفات لا تظهر هنا، بل موجودة في الإعدادات فقط.

⸻

6. سلوك ذكي:
	•	إذا لم يكن هناك أي ملفات مخفية → تظهر صورة “فارغة” مع نص “لا توجد ملفات مخفية”.
	•	إذا حاول المستخدم غير المشترك إخفاء ملف زائد عن الحد → تظهر له نافذة منبثقة تطلب الاشتراك.

⸻

جميل، ننتقل الآن إلى:

⸻

شاشة سلة المحذوفات – TrashView (trash_view.dart)

1. الوظيفة الأساسية:
	•	عرض الملفات التي تم حذفها مؤقتًا من التطبيق (ولم تُحذف نهائيًا بعد).
	•	يمكن استعادة الملفات منها أو حذفها بشكل نهائي.
	•	الملفات تبقى في السلة لمدة 30 يومًا فقط، ثم تُحذف تلقائيًا.

⸻

2. الخصائص والمكونات:

أ. الهيكل العام:
‏	•	AppBar بعنوان: “سلة المحذوفات”
	•	قائمة بكل الملفات التي تم حذفها.
	•	عرض كل ملف مع بياناته: الاسم – النوع – تاريخ الحذف – الحجم.
	•	نص توضيحي يظهر في الأعلى:
“يتم حذف الملفات نهائيًا بعد 30 يومًا من تاريخ الحذف.”

⸻

ب. كل ملف يحتوي على:
	•	أيقونة نوع الملف.
	•	اسم الملف.
	•	زر خيارات (⋮) يحتوي على:
	•	استعادة إلى مكانه السابق (إلى “ملفاتي” أو “الملفات المخفية”).
	•	حذف نهائي.

⸻

3. السلوك الذكي:
	•	عند حذف ملف من “ملفاتي” أو “الملفات المخفية”، يُنقل تلقائيًا إلى سلة المحذوفات.
	•	عند مرور 30 يومًا → يُحذف الملف تلقائيًا من النظام.
	•	عند محاولة فتح الملف داخل السلة → يظهر تنبيه: “لا يمكن تشغيل الملفات من سلة المحذوفات”.

⸻

4. الربط البرمجي:
	•	إدارة السلة: TrashService.
	•	التحكم بالسلوك والواجهة: TrashController.
	•	التخزين المؤقت للمعلومات: SecureStorageService أو قاعدة بيانات محلية.

⸻

5. الخصوصية:
	•	لا يمكن تشغيل الملفات مباشرة.
	•	لا يمكن مشاركة الملفات أثناء وجودها في السلة.
	•	لا تظهر هذه الملفات في أي شاشة أخرى داخل التطبيق.

⸻

6. التصميم والهوية:
	•	نفس تصميم الشاشات الأخرى.
	•	الخلفية الموحدة.
	•	دعم الوضع الليلي.
	•	عند عدم وجود ملفات → تظهر صورة “فارغة” توضح أن السلة فارغة.

⸻

7. الإعدادات:
	•	في صفحة “الإعدادات” يوجد زر تفعيل/إيقاف سلة المحذوفات.
	•	عند إيقافها → يتم حذف الملفات مباشرة دون إرسالها للسلة.

⸻

ممتاز، ننتقل الآن إلى:

⸻

شاشة رفع الملفات – UploadView (upload_view.dart)

1. الوظيفة الأساسية:
	•	رفع الملفات من التطبيق مباشرة إلى Google Drive.
	•	يتم رفع الملفات من داخل “ملفاتي” أو من واجهة مستقلة عند فتح الزر العائم (➕).
	•	يربط بين المستخدم وحسابه في Google ويطلب الإذن لمرة واحدة فقط.

⸻

2. السيناريوهات الأساسية:
	•	رفع يدوي: عند الضغط على زر “رفع إلى Google Drive” في خيارات الملف.
	•	رفع تلقائي (للمشتركين فقط): يتم تمكينه من “الإعدادات”، ويقوم برفع جميع الملفات تلقائيًا بعد التنزيل.

⸻

3. مكونات الشاشة:

أ. AppBar علوي:
	•	بعنوان: “رفع إلى Google Drive”
	•	زر رجوع فقط.

ب. قائمة الملفات المتاحة للرفع:
	•	تعرض جميع الملفات التي لم تُرفع بعد.
	•	كل عنصر يحتوي على:
	•	اسم الملف.
	•	الحجم.
	•	تاريخ الإنشاء.
	•	حالة الرفع: “جاهز للرفع” – “تم رفعه” – “جاري الرفع”.

ج. زر تنفيذ الرفع:
	•	زر سفلي واضح (Upload Now).
	•	عند الضغط:
	•	يطلب تسجيل الدخول إلى Google (عند الحاجة).
	•	يبدأ الرفع للملفات المحددة.
	•	يظهر شريط تقدم (Progress).

⸻

4. السلوك البرمجي والذكاء:
	•	عند رفع الملف:
	•	يتم حفظ حالة “تم الرفع” في user_provider.
	•	يتم تغيير الأيقونة بجانب الملف إلى ✅ أخضر.
	•	في حال فشل الرفع:
	•	يظهر تنبيه مع إمكانية إعادة المحاولة.

⸻

5. الربط البرمجي:
	•	يستخدم GoogleSignIn للمصادقة.
	•	يستخدم DriveApi من Google APIs.
	•	الخدمة المسؤولة: UploadService.
	•	الكنترولر المسؤول: UploadController.

⸻

6. قيود المستخدمين:
	•	المجاني:
	•	يمكنه رفع ملفات حتى 5GB في اليوم.
	•	لا يمكن تفعيل الرفع التلقائي.
	•	المشترك:
	•	لا توجد حدود.
	•	الرفع التلقائي متاح.
	•	ملفات مخفية يمكن رفعها أيضًا.

⸻

7. واجهة فنية:
	•	دعم الوضع الليلي.
	•	مؤثرات تحميل سلسة.
	•	التحقق من حالة الاتصال قبل البدء.
	•	إشعار بعد الرفع الناجح باستخدام NotificationService.

⸻
